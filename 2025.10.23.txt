Switch(config-if)#spanning-tree portfast 


Port-Security란?
: 특정 포트에 학습할 수 있는 MAC주소의 수를 제한하여 허가된 Mac만 접속 가능하도록 설정하는 것.
 
원래 스위치는 하나의 포트에서 여러 Mac주소를 학습할 수 있도록 되어있고 그 수가 제한적이지 않다. 이러한 특성을 이용하여 랜덤하게 생성된 Mac주소를 출발지로 하여 수 많은 Frame을 스위치로 전달하게되면, 스위치는 모든 주소를 학습하여 결국엔 Mac-address-table이 가득차게 된다. 더 이상 Mac주소를 학습할 수 없게 된 스위치는 그 뒤에 들어오는 모든 Frame을 Flooding 시켜서 마치 허브처럼 동작될 수 있다.
위와 같이 공격하는 기법을 Mac Flooding Attack 이라고 한다.
Port security를 설정하면 하나의 포트에 학습할 Mac주소의 수를 제한할 수 있기 때문에 이런 공격을 방어할 수 있다.
 
또한, 내부 네트워크까지 침입한 공격자는 Sniffing 환경을 구성하기 위해 위 방법 외에 중간자공격 MITM(Man in The Middle)을 실행할 수도 있다. 이런 공격으로 대표적인 것은 Mac주소를 변경하여 다른 디바이스 통신 사이에 끼어드는 ARP Spoofing이 있는데 이는 가장 기본적인 공격이며 눈치채기도 어렵다.  
Port security 설정은 관리자가 통신을 허용할 장비의 Mac주소를 수동으로 지정할 수도 있기 때문에 이러한 공격이 무용지물이 될 수 있다.

S1(config)#int f0/1
S1(config-if)#switchport mode access
S1(config-if)#switchport port-security maximum 2
S1(config-if)#switchport port-security violation shutdown
S1#show port-security
S1#show port-security int fa0/1

- 맥주소를 확인방법
S1# show mac-address-table
S1(config-if)#switchport port-security mac-address 0060.7075.5CA0


no switchport mode access
no switchport port-security
no switchport port-security maximum 2
S1#clear port-security configured
S1#clear port-security dynamic
S1#clear port-security sticky
S1#clear port-security all


S1(config)#int f0/1
S1(config-if)#switchport mode access
S1(config-if)#switchport port-security
S1(config-if)#switchport port-security mac-address 0060.7075.5CA0
S1(config-if)#switchport port-security violation shutdown
S1#show port-security
S1#show port-security int fa0/1
Switch#show port-security address

S1#erase startup-config
S1#reload



- 라우팅 프로토콜 정리하고 진행하자
1. 정적(Static)
1) 장점
 - 라우팅 테이블을 이해하기 쉽다.
 - 목적지 주소를 직접 입력하여 관리 할 수 있어 안정적이다.
2) 단점
 - 네트워크 변화가 심할때 부적합하다.
 - 큰 네트워크에서 부적합하다.
 - 우회경로 이용 등이 곤란하다.
2. 동적(Dynamic) - RIP, IGRP, EIGRP, OSPF 등
1) 장점
 - 네트워크의 변화에 능동적으로 대처
 - 큰 네트워크에서 접합
 - 다양한 경로 이용 가능
2) 단점 설정 및 운영 지식

2. 라우팅 프로토콜 분류
1) Aotonomous System : 독자접인 관리체계(ISP)
2) IGP(Interior Gateway Protocol)
 - 하나의 AS 또는 인트라넷에서 사용되는 프로토콜
 - RIP, IGRP, EIGRP, OSPF, IS-IS
3) EGP(Exterior Gateway Protocol)
 - AS와 AS간에 사용되는 라우팅 프로토콜
 - BGP4
4) (AS : IGP(RIP,OSPF....))Interior <---> EGP(BGP) Exterior <--->  (AS : IGP(RIP,OSPF....))

3. 관리거리(Administrative Distance)
Static Route 1
EIGRP 90 (Internal)
OSPF 110
RIP 120

4. 단일(Single)라우팅, 다중(Multi)라우팅
- Single 라우팅(Single Routing)과 멀티 라우팅(Multi Routing)은 네트워크에서 패킷이 전달되는 경로 설정 방식의 차이를 의미
1) Single Routing (단일 라우팅)
 - 경로 설정: 단일 라우팅은 출발지에서 목적지로 가는 유일한 경로를 설정하는 방식이다.
 - 고정 경로: 패킷이 항상 동일한 경로를 통해 전달된다.
 - 단순성: 네트워크의 복잡도가 낮기 때문에 구현 및 관리가 간단하다.
 - 효율성 제약: 특정 경로에 문제가 발생하면 패킷이 제대로 전달되지 않을 수 있다.
 - 적용 사례: 소규모 네트워크 또는 트래픽이 많지 않은 단순한 네트워크에서 자주 사용된다.
 - Single Routing은 하나의 경로만을 사용하며 단순하지만 장애에 취약합니다.
 - Single 라우팅: RIP, IGRP

2) Multi Routing (다중 라우팅)
 - 경로 설정: 여러 경로를 설정하여 패킷이 다양한 경로를 통해 목적지에 도달할 수 있게 하는 방식이다.
 - 동적 경로: 패킷이 상황에 따라 다른 경로를 선택해 전송될 수 있다.
 - 복잡성 증가: 여러 경로를 관리하고 최적의 경로를 선택하는 알고리즘이 필요하기 때문에 관리가 더 복잡하다.
 - 유연성 및 신뢰성: 한 경로에 장애가 발생해도 다른 경로를 통해 패킷을 전달할 수 있어 네트워크의 신뢰성이 높아진다.
 - 적용 사례: 대규모 네트워크, 트래픽이 많은 네트워크 또는 고가용성이 요구되는 환경에서 사용됩니다. 예를 들어 인터넷 백본망에서는 여러 경로를 통해 데이터가 전송된다.
 - Multi Routing은 여러 경로를 사용하여 유연하고 신뢰성이 높지만 복잡하다.
 - EIGRP, OSPF, BGP

4. 라우터 계층 구조
1) 평면(Flat) 구조 라우팅 프로토콜
 - Flat 라우팅은 네트워크의 모든 라우터가 동일한 수준에서 동작하며, 라우터 간에 위계 구조가 없다. 네트워크에 있는 모든 라우터가 경로 정보를 공유하여 네트워크 전체의 라우팅 정보를 갖고 있다.
 - 모든 라우터가 동일한 경로 정보를 유지.
 - 경로 계산이 단순하지만, 네트워크가 커질수록 확장성과 성능 문제 발생 가능.
 - 네트워크 규모가 크면 라우팅 테이블 크기가 커지고, 브로드캐스트 트래픽이 증가.
 - RIP (Routing Information Protocol): 거리 벡터 기반 라우팅 프로토콜로, 작은 네트워크에서 효과적이지만 큰 네트워크에서는 확장성 문제를 겪을 수 있다.
 - IGRP (Interior Gateway Routing Protocol): Cisco에서 개발한 거리 벡터 프로토콜로, 주로 소규모 네트워크에서 사용된다.
 - EIGRP (Enhanced Interior Gateway Routing Protocol): IGRP의 확장판으로, 네트워크 전반에 걸쳐 동일한 레벨에서 동작할 수 있지만 계층적 구조도 지원한다.

2) 계층(Hierarchical) 구조 라우팅 프로토콜
 - Hierarchical 라우팅은 네트워크를 여러 레벨 또는 계층으로 나누어 관리하는 방식이다. 이를 통해 네트워크를 작은 단위로 나누어 관리하여 확장성과 성능을 개선할 수 있다.
 - 네트워크를 여러 영역으로 분할하여 관리, 각각의 영역 내에서만 상세한 경로 정보를 교환.
 - 영역 간에 경로 정보를 축약하여 전파, 라우팅 테이블 크기 및 네트워크 트래픽 감소.
 - 대규모 네트워크에서 확장성과 효율성이 뛰어남.
 - OSPF (Open Shortest Path First): 링크 상태 기반 라우팅 프로토콜로, 네트워크를 여러 영역으로 나누어 관리할 수 있다. OSPF는 기본적으로 계층적인 구조를 사용하며, 주요 계층은 백본 영역(Area 0)과 다른 여러 영역으로 구성된다.
 - IS-IS (Intermediate System to Intermediate System): OSPF와 유사한 링크 상태 프로토콜로, 계층적 구조를 지원한다. IS-IS는 두 레벨(Level 1, Level 2)로 나뉘어 계층적으로 동작한다.
 - BGP (Border Gateway Protocol): 주로 자율 시스템 간의 경로를 설정하는 데 사용되며, 네트워크의 계층적 구조를 지원한다. 특히 BGP는 자율 시스템 간 경로 정보의 교환을 통해 대규모 네트워크에서 효율적으로 경로를 관리한다.

5. Distance Vector (거리 벡터) 방식, Link State (링크 상태) 방식
1) Distance Vector (거리 벡터) 방식
 - 각 라우터가 인접 라우터로부터 거리 정보를 받아 자신의 라우팅 테이블을 갱신하며, 경로의 거리를 기준으로 최적 경로를 선택하는 방식이다. 주기적으로 인접 라우터들과 경로 정보를 교환한다
 - RIP, IGRP, EIGRP
2) Link State (링크 상태) 방식
 - 각 라우터는 자신에게 직접 연결된 망정보, 즉 링키(link) 상태 정보를 망내의 모든 라우터에게 멀티캐스트로 전송하며, 이때 링크 정보는 변동 사항이 있을 때만 전송한다. 트래픽을 줄이고 거리 벡터 방식의 단점을 극복하기 위해 개발된 프로토콜로 네트워크에 대한 모든 상태 정보를 수집하여 최적의 경로를 계산하는 방식이다.
 - OSPF, IS-IS



- RIP
1. Classful Addressing (ClassFull 방식, 과거에 사용)
 - IP 주소를 A, B, C, D, E 클래스 중 하나로 나누는 고전적인 방식이다. 
 - 네트워크와 호스트를 구분하는 범위는 IP 주소의 첫 번째 몇 비트로 결정된다.
 - Major 네트워크라 한다.
 - RIP는 기본적으로 Classful 프로토콜이었기 때문에, 경로를 전송할 때 서브넷 마스크 정보를 포함하지 않는다. 
이를 위해 auto-summary 기능이 활성화되면, 서로 다른 네트워크로 넘어갈 때 서브넷 경로 정보를 요약된 ClassFull 네트워크로 묶어서 광고한다.
 - Classless 라우팅 (CIDR 기반 라우팅) : IP 주소 + 서브넷 마스크(prefix) 전송, 클래스 상관없이 프리픽스 기반 판단
   RIP v1은 Classful 프로토콜로 서브넷 마스크를 포함하지 않으며, VLSM과 CIDR을 지원하지 않는다.
   RIP v2는 Classless 프로토콜로 서브넷 마스크를 포함하여 VLSM과 CIDR을 지원한다.

2. 라우터 광고(advertisement)는 네트워크 경로 정보, 즉 어떤 네트워크로 어떻게 가는지를 다른 라우터들에게 알리는 과정을 의미한다. 라우터들은 이 광고를 통해 각자 알고 있는 네트워크 경로를 서로 공유하며, 이를 바탕으로 라우팅 테이블을 갱신하고 트래픽을 효율적으로 전달한다. (라우터는 인접해 있는 라우터와 광고한다.)


sparta --->  명령어 8줄   --> 1줄
--------------------------------
- 테스팅 ----> 옵션,,, 명령,,,,    (단순)

- 목록화(리스트, 정보)


R    203.116.9.0/24 [120AD/Hop1] via(gateway) 204.200.7.1, 00:00:02, Serial0/2/0

R    168.126.0.0/16 [120/1] via 204.200.7.2, 00:00:25, Serial0/2/0


- 설명
auto-summary 기능은 클래스풀(Classful) 네트워크 경로 요약을 자동으로 수행하는 기능이다. 
즉, 클래스풀 경계(Classful Boundary)에서 서브넷을 자동으로 요약하여 네트워크 경로를 간단하게 광고하는 것을 의미한다.

172.16.1.0/24와 172.16.2.0/24 두 개의 서브넷이 있을 때, 이 두 서브넷은 클래스 B 네트워크(172.16.0.0/16)에 속하므로 auto-summary가 활성화되면 요약된 네트워크인 172.16.0.0/16이 경로로 광고된다.

장점 : 라우팅 테이블이 단순화된다. 요약된 경로만 광고되므로 네트워크 간 트래픽이 적다.
단점 : VLSM(Variable Length Subnet Mask)/CIDR을 사용하는 환경에서 문제가 발생할 수 있다. 여러 다른 서브넷을 정확하게 나누고 싶을 때, 경로가 요약되어 잘못된 경로로 전송될 수 있다.

이러한 요약으로 인해 경로가 잘못 요약되거나, 경로 혼란이 발생할 수 있기 때문에 VLSM과 CIDR을 사용하는 현대 네트워크에서는 auto-summary를 비활성화하는 것이 일반적입니다. RIP 버전 2에서는 no auto-summary 명령어로 이를 비활성화할 수 있다.


Passive-Interface
라우터에서 라우팅 프로토콜을 설정하면 지속해서 전송이 필요치 않은 인터페이스에서도 라우팅 테이블
명령이 전달되어 전송 대역폭을 소비하고 라우터의 성능을 떨어 뜨리게 된다.
Passive-Interface란 이러한 기본적인 라우터의 전송 기능을 지정한 인터페이스로 전송하는 것을
중지시켜 특정 인터페이스로 정보를 전송하지 않게 하는 설정이다.

R1#show ip protocols
R1#show ip interface br
R1#show ip rip database
R1(config-router)#passive-interface fa0/1





와일드 카드 마스크

1. 서브넷 마스크와 구분하기 위해서 ‘0’과 ‘1’을 반대로 사용한다.
2. 맨 앞에 비트부터 ‘1’과 ‘0’이 불연속이 가능한 32bit 체계 마스크(서브넷마스크와 다르다.)
 – 장점 : 긴 설정을 짧게 함, 특정 서브넷만 설정 가능함
 – 사용 : EIGRP, OSPF, ACL
3. 아이피는 공통비트에서 1값만  계산한다(공통비트외 1비트값)
4. 예를들어 192.168.1.0/24 네트워크를 와일드카드 마스크로 범위를 지정하면
IP        : 11000000.10101000.00000001.00000000
와일드 카드 마스크  : 00000000.00000000.00000000.11111111  (이다 이때 IP와 와일드 카드 마스크에서)
와일드 카드 마스크 비트가 0에 매칭되는 IP비트는 불변한다. (예, A클래스 11000000 부분은 그대로 이다.)
와일드 카드 마스크 비트가 1에 매칭되는 IP비트는 변할 수 있다.(0이 오던 1이 오던 상관하지 않겠다는 의미)
따라서 젤뒤에 8비트만 변화해서 0~255까지 범위를 나타낼 수 있다.

- 서브넷을 와일드 카드 마스크로 변환시
255.255.255.255  -> 0.0.0.0
255.255.255.0 -> 0.0.0.255
255.255.0.0 -> 0.0.255.255
0.0.0.0 -> 255.255.255.255
255.255.255.252 -> 0.0.0.3   ( 즉 255 - 252 = 3 )
255.255.255.224 -> 0.0.0.31
255.255.254.0 -> 0.0.1.255
255.255.248.0 -> 0.0.7.255 

4. 와일드 카드 마스크 표기 방식
 
(1) 특정 호스트와 매칭하기
      와일드 카드 마스크의 32개 비트가 전부 0 이라면
      조건으로 지정한 주소와 반드시 일치해야 하며,
      이는 특정 호스트를 제어하기 위해 사용된다.
      이와 같이 특정 호스트를 제어하고자 하는 경우
      와일드 카드 마스크를 다음과 같이 2가지 방식으로 표기할 수 있다. 
            호스트 1172.16.10.10  0.0.0.0   또는   host  172.16.10.10
72.16.10.10으로 부터 들어오는 모든 패킷을 모두 거부하겠다는 내용이며
      Access List에서 host 명령어는 default로 설정되어 있으므로
      host 명령어를 빼고 표현할 수도 있다.
 
 
      명령어 :: Router(config)#  access-list 1 deny [host][IP_address] 
                    Router(config)#  access-list 1 deny [IP_address]
                    Router(config)#  access-list 1 deny [IP_address] 0.0.0.0
 
 
(2) 모든 IP 주소와 매칭하기
      와일드 카드 마스크의 32개 비트가 모두 1이라면 
      조건으로 지정한 주소와 관계없이 어떤 주소도 된다는 것을 의미하며,
      모든 호스트 컴퓨터를 제어하기 위해 사용된다.
      이와 같이 모든 호스트를 제어하고자 하는 경우
      와일드 카드 마스크를 다음과 같이 2가지 방식으로 표기할 수 있다.
      172.16.10.10  255.255.255.255   또는   any  (모든것)
      여기서 172.16.10.10이라는 주소는 아무 의미가 없으므로 주로 0.0.0.0(IP)을 많이 사용한다.
      Access List에서 any라고 표현된 경우는
      와일드 카드 마스크가 0.0.0.0  255.255.255.255 이다.
 
 
      명령어 :: Router(config)#  access-list  1  deny  [IP_address] 255.255.255.255 
                    Router(config)#  access-list  1  deny  any



1. IP 범위 설명 : 172.30.16.0/24 ~ 172.30.31.255/24
 1) 172.30.16.0    = 10101100.00011110.0001 0000.00000000
 2) 172.30.31.255 = 10101100.00011110.0001 1111.11111111
                        00000000.00000000.0000 1111.11111111

 → 여기서 확인할 수 있는 건 : 앞의 20비트는 고정됨, 나머지 12비트는 자유롭게 변함
 3) 결과 : 주소 172.30.16.0 와일드카드 마스크 0.0.15.255
 → 즉: 앞의 20비트는 체크하고, 나머지 12비트는 무시하라는 의미
 4) 앞의 20비트는 공통 → 와일드카드 마스크에서 0
 5) 뒤의 12비트는 다양 → 와일드카드 마스크에서 1

2. 와일드카드 마스크의 비트 의미(공통비트는 비교, 비공통비트는 무시 이다.)
 1) 0 은 검사함 IP 주소의 해당 비트를 비교한다 (공통 여부 확인)
 2) 1 은 무시함 IP 주소의 해당 비트는 비교하지 않음 (어떤 값이든 상관없음)
 3) 와일드카드 마스크에서는 불연속적인 0과 1도 가능하다.

3. 비트 패턴설명
00000000 모든 비트를 검사함 (Match All → 공통 비트)
00111111앞  2비트만 검사, 나머지는 무시
00001111앞  4비트는 검사, 뒤 4비트는 무시
11111100뒤  2비트만 검사, 앞은 무시
11111111모두 무시 (비교하지 않음 → 모두 비공통)











