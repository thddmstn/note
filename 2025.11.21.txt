[ 스캔의 종류 및 특징 ]
UDP 스캔(-sU UDP포트 스캔)
- 대상 시스템을 대상으로 UDP 패킷을 전송
- 서비스 포트가 Open 되어 있을경우 응답 없음
- 서비스 포트가 Close 되어 있을경우 ICMP unreachable 회신
-UDP 특성상 스캔은 신뢰성이 저하됨 
wireshark (UDP만 추출)
1. 접속자 IP만 보도록 필터링
2. 서버 IP만 보도록 필터링
3. 프로토콜 UDP만 보도록 필터링
4. 프로토콜 ICMP만을 보도록 필터링
ip.src == 192.168.0.112 && ip.dst == 192.168.0.15 && udp && icmp
UDP와 ICMP가 동시에 포함된 경우 접속실패로 가정할 수 있기 때문에
ICMP가 포함되지 않는 경우를 UDP 접속성공이라고 가정할 수 있다.
ip.src == 192.168.0.112 && ip.dst == 192.168.0.15 && udp && not(!)icmp

TCP 전체 연결 스캔(TCP open) nmap -sT
- 대상 시스템을 대상으로 TCP SYN 패킷을 전송
- 서비스 포트가 Open 되어 있을 경우 SYN+ACK패킷을 회신후 ACK전송
- 서비스 포트가 Close 되어 있을 경우 RST+ACK패킷회신
3way handshake 과정 수행으로 로그 기록이 남고 스캔 속도가 느림

Stealth 스캔
- 스캔하는 대상에 단순히 로그를 남기지 않는다.
- 공격 대상을 속이고 자신의 위치 또한 숨기는 스캔이다.
종류 : TCP Half Open, FIN, Xmas, Null

TCP 반개방 스캔(TCP Half Open) nmap -sS IP
- 대상 시스템을 대상으로 TCP SYN 패킷을 전송
- 서비스 포트가 Open 되어 있을 경우 SYN+ACK패킷 회신 후 RST전송
- 서비스 포트가 Close 되어 있을 경우 RST+ACK패킷 회신
-완전한 세션을 성립하지 않고 포트의 활성화를 확인하므로 로그가 남지 않음

FIN 스캔(-sF TCP FIN 스캔 (FIN 패킷을 이용한 스캔))
- 대상 시스템을 대상으로 TCP FIN 패킷을 전송
- 서비스 포트가 Open 되어 있을 경우 응답 없음
- 서비스 포트가 Close 되어 있을 경우 RST패킷 회신

Xmas 스캔(-sX TCP Xmas 스캔 (FIN,PSH,URG 패킷을 이용한 스캔))
- 대상 시스템을 대상으로 TCP FIN, PSH, URG 패킷을 전송
- 서비스 포트가 Open 되어 있을 경우 응답 없음
- 서비스 포트가 Close 되어 있을 경우 RST패킷 회신

Null 스캔(nmap -sN)
- 대상 시스템을 대상으로 TCP Null 패킷을 전송
- 서비스 포트가 Open 되어 있을 경우 응답없음
- 서비스 포트가 Close 되어 있을 경우 RST패킷회신

ACK 스캔(-sA)
일반적으로 포트가 확실히 막혀 있는지를 보기 위해 침입 차단시스템 규칙을 검사하는데 사용
ACK 스캔은 윈도우 스캔 기법 (-sW) 이 사용되지 않는 한 열려 있는 포트를 식별하는 데에도 사용되지 않는다.
TCP 핸드 쉐이크 과정은 없다.
- 대상 방화벽이 상태 기반(Stateful)인지 여부
- 대상 포트가 방화벽에 의해 필터링 되고 있는지 여부
스캔방법
ACK 플래그만 설정해서 보낸다.
방화벽에서 필터링 된다면 응답이 없거나 ICMP 에러 메시지를 받고
방화벽에서 필터링 되지 않는다면 RST 응답을 받는다.


IP 프로토콜 스캔 (-sO)
아이들 스캔(-sI <zombie host> [:probeport])   (대문자 i)
스캐너가 목적지와 직접 통신하는 것이 금지됐을 때 사용된다.

대역을 모두 스캐닝시
#nmap -sS -P 80,8080 192.168.0./24 -oA 192.168.0.1.xml
* 스캐닝할 때 포트를 지정해서 하자 아니면 무한정 기다려야 할 수 도있다. *





-▷ Nmap 정의
 ∙ 특정 호스트(시스템)의 어떤 포트가 열려 있는지(서비스가 리스닝 중인지) 확인하는 도구/행위.
 ∙ 포트 → 서비스 → 버전 → 취약점으로 이어지는 초기 정보수집 단계.
▷ 동작 원리(두 가지 관점)
 ∙ 반응 기반(positive) : 대상에 직접 프로브를 보내고 오는 응답(예: SYN+ACK, banner) 으로 포트 상태를 확인.
 ∙ 부재/간접(negative) : 응답이 없거나 특정 패턴의 부재를 통해 필터됨/닫힘 등을 추론(예: 방화벽이 모든 패킷에 RST로 응답하거나 아무 응답도 안 할 때).
 ∙ (현실) 대부분의 스캐너는 두 방식 요소를 모두 사용 — 직접 응답을 확인하고, 응답 부재로부터 필터링 여부를 추론함.
▷ 네트워크 서비스 스캐닝은 “열려 있는 문(포트)” 뒤에 “어떤 프로그램이 있는가”를 알아내는 과정이다. 이를 통해 공격자는 침투 기회를, 방어자는 취약점 차단 지점을 찾는다.



- 네트워크 서비스 스캐닝
1. 개념
 • 열려 있는 포트에서 어떤 네트워크 서비스가 실행 중인지 확인하는 행위
 • 포트는 단순한 번호가 아니라, 서비스가 열려 있는 “통신 창구” 역할
2. 목적
 • 각 포트에서 어떤 서비스(HTTP, SSH, FTP 등)가 동작 중인지 식별
 • 공격자는 서비스를 통해 접근하므로, 서비스 식별이 공격의 출발점
3. 중요성
 • 네트워크 공격은 대부분 서비스와의 통신을 기반으로 함
 • 따라서 서비스 탐색 후 → 버전 파악 → 취약점 분석으로 이어짐
 • “어떤 서비스가 열려 있느냐”가 방어/공격 양쪽 모두에서 핵심 정보
4. 주요 스캔 기법
 • Banner Grabbing: 서비스가 보내는 환영 메시지(Banner)로 버전/제품 확인 (-sV)
 • Network Service Footprinting: 서비스 구조 및 동작 특성 분석
 • Enumeration(열거): 사용자, 공유 폴더, 권한 등 세부 정보 수집
5. 핵심 포인트
 • 단순히 포트를 찾는 것이 아니라, 포트 뒤에 어떤 서비스가 있는지를 식별해야 함
 • 서비스별로 통신 방식·공격 기법이 다르므로, 서비스 이해가 보안의 출발점
6. 다른 포트 스캐너들 (용도/특징)
 • Masscan : 초고속 포트 스위프(인터넷 스케일 탐색) — 정확도 낮음, 발견된 포트만 후속으로 정밀검사 권장.
 • RustScan : 빠른 포트 검색 + Nmap 자동 연계(빠른 프론트엔드 역할).
 • Axiom, ZMap 등: 분산/대규모 스캔용 툴.
7. 실무 권장 워크플로우 (규모별)
 • 대규모(인터넷 스케일): Masscan / ZMap → 열린 포트 목록 생성
 • 정밀검사: Nmap으로 발견된 포트 -sV, --script 등으로 상세 분석
 • 내부 테스트: 속도 낮추고 병렬성 제한, 장비 부하/정책 고려



- 실무 체크리스트
1. Virtual Hosting
 • 같은 IP에 여러 도메인(Virtual Host)이면 서비스/도메인별 결과가 겹칠 수 있음. 도메인별 확인이 필요하면 HTTP Host 헤더 검사나 웹 애플리케이션 레벨 탐지 병행.
2. 속도 vs 정확도 (원칙)
 • 속도 ↑ → 정확도 ↓, 차단 확률 ↑. 빠른 스캔은 오탐·블랙리스트·네트워크 과부하 초래.
 • 권장: 테스트 환경에서 --min-rate를 단계적으로 올려 최적값 탐색.
3. 외부망(Internet) 모의해킹 권장사항
 • 10개 이상 연속 포트 스캔은 탐지/블랙리스트 위험↑.
 • 분산 스캔 또는 슬로우 스캔 사용(Axiom, 분산 인프라).
 • 퍼블릭 대상은 법적·정책적 허가 확인 필수.
4. 내부망 모의해킹 주의사항
 • 과도한 TCP SYN(-sS) 스캔은 방화벽/라우터/스위치에 부하를 줄 수 있음. 내부 장비 영향 고려.
 • 내부에서는 낮은 병렬성/느린 속도로 테스트하거나 시간/세그먼트 분할 권장.
5. 대규모 타깃 워크플로우 (실전)
 • 1단계: Masscan / Axiom — 빠른 포트 발견(고속, 낮은 정확도)
 • 2단계: Nmap — 발견된 포트만 정밀 스캔(-sV, --script 등)
 • 이유: 자원 절약 + 오탐 줄이기
6. "모든 포트 열림" 결과가 나올 때
 • 대부분 거짓 양성(방화벽 리스폰스, TCP 접속 프록시, IDS/IPS 응답)
 • 확인법: 다른 스캔타입(-sT vs -sS), --packet-trace, --script-trace, 와이어샤크 확인
7. 로컬 네트워크(같은 서브넷) 특별사항
 • Nmap은 로컬 대상에 ARP 사용 — -Pn을 써도 MAC 해상 때문에 ARP가 발생함.
 • ARP 비활성: --disable-arp-ping (주의: 정확도/성능 영향)
8. 유용한 Nmap 옵션 예시(짧게)
 • -sS : SYN 스캔 (스텔스)
 • -sT : TCP connect 스캔 (권한 낮아도 됨)
 • -Pn : 호스트 발견(skip) 생략 → 바로 스캔
 • --min-rate 1000 : 최소 패킷 전송률(속도조절)
 • --packet-trace / --script-trace : 디버깅용 상세 출력
 • --disable-arp-ping : ARP ping 비활성화
9. 실무 팁 / 체크리스트
 • 항상 범위·허가(Authorization) 먼저 확인.
 • 대규모 스캔은 시간대 분할 & 샘플링 후 확대.
 • 로그/트래픽(IDS, 라우터 CPU) 모니터링 병행.
 • 결과는 교차검증(다른 툴/타입으로 재검)할 것.
 • 민감 정보(자격증명 등) 로그에 남지 않게 주의.
10. “빠르게 스캔하면 문제를 놓치거나 차단될 수 있으니, 분산·단계적 접근과 교차검증을 기본으로 하라.”

